{"version":3,"sources":["images/logo-vaa.svg","images/locate.svg","images/camera.svg","images/download.svg","images/bij.png","images/tent.png","images/tree.png","images/windmill.png","utils/leaflet-helpers.js","utils/wfs-helper.js","viewer/viewer.js","graph/graph.js","open-layers/open-layers.js","pic/index.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","getCrs","mapRef","current","leafletElement","options","crs","createWfs","name","url","resource","typename","minZoom","maxZoom","features","retrieveWFSFeatures","_x7","_retrieveWFSFeatures","apply","this","arguments","_callee2","componentContext","regenerator_default","a","wrap","_context2","prev","next","abrupt","Object","entries","state","wfsServices","filter","_ref7","_ref8","slicedToArray","key","selectedWfsService","map","_ref9","_ref10","value","retrieveFeatures","stop","_x8","_x9","_x10","_x11","_retrieveFeatures","_callee3","bounds","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_loop","_iterator","_step","_value","_context3","getBounds","setState","produce","draft","stateFeatures","filteredFeatures","feature","find","stateFeature","id","_draft$wfsServices$ty","push","toConsumableArray","asyncIterator","getPlotsGeoJSONData2","sent","done","t0","return","finish","_callee","southWest","northEast","bbox","wfsUrl","getPlots","response","json","totalFeatures","nextResponse","nextJson","_context","project","getSouthWest","getNorthEast","concat","x","y","startIndex","fetch","awaitAsyncGenerator","console","log","length","onPointToLayer","latlng","circleMarker","radius","fillColor","color","weight","opacity","fillOpacity","shorten","maxLength","undefined","first","last","toString","pre","substr","app","wfsServiceDropdown","react_default","createElement","className","onChange","e","target","zoom","forceUpdate","selectWfsService","_ref5","_ref6","BaseLayer","React","Component","LayersControl","Overlay","Viewer","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","createRef","handleFeatureClick","selectedLayer","setStyle","layer","bringToFront","locateUser","locate","setView","watch","handleLocationFound","accuracy","L","marker","addTo","bindPopup","openPopup","circle","dragged","lat","lon","_len","wfss","Array","_key","forEach","wfs","registerWFS","position","Fragment","src","logo","alt","onClick","promptInstall","download","Link","to","camera","Map","center","onZoomEnd","curr","getZoom","onDragEnd","handleDragEnd","handleClick","onLocationfound","ref","zoomControl","attributionControl","AttributionControl","ZoomControl","checked","TileLayer","attribution","LayerGroup","WMSTileLayer","layers","transparent","format","onFeatureClick","_ref","_ref2","_ref3","_ref4","FeatureGroup","geoJSONData","GeoJSON","data","style","pointToLayer","createFeatureLayers","PureComponent","OpenLayers","_PureComponent","onRadioChange","radio","currentTarget","inherits","createClass","source","OSM","view","View","prevProps","prevState","currentLayer","removeLayer","vectorSource","VectorSource","readFeatures","Bestemmingsplan","VectorLayer","Style","fill","Fill","stroke","Stroke","width","addLayer","vectorSource2","Natuur","type","htmlFor","windmill","tree","bij","tent","Pic","height","streaming","video","canvas","photo","startbutton","startrecording","paintVideo","getContext","drawImage","paused","requestAnimationFrame","useCamera","muted","setAttribute","play","navigator","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","Promise","resolve","reject","Error","_this2","document","playsinline","addEventListener","facingMode","then","stream","srcObject","window","URL","createObjectURL","catch","err","ev","takepicture","preventDefault","toDataURL","accept","capture","onclick","App","Switch","Route","exact","path","component","render","viewer_viewer","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","error","deferredPrompt","ReactDOM","BrowserRouter","basename","process","src_App_0","prompt","getElementById","origin","status","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.821edb4f.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo-vaa.c5b9232d.svg\";","module.exports = __webpack_public_path__ + \"static/media/locate.100f6971.svg\";","module.exports = __webpack_public_path__ + \"static/media/camera.8c1ff4f8.svg\";","module.exports = __webpack_public_path__ + \"static/media/download.dbfe7e69.svg\";","module.exports = __webpack_public_path__ + \"static/media/bij.baccab47.png\";","module.exports = __webpack_public_path__ + \"static/media/tent.8fb47b2d.png\";","module.exports = __webpack_public_path__ + \"static/media/tree.f3c11276.png\";","module.exports = __webpack_public_path__ + \"static/media/windmill.cc3908f0.png\";","export function getBounds(mapRef) {\r\n  return mapRef.current.leafletElement.getBounds();\r\n}\r\n\r\nexport function getCrs(mapRef) {\r\n  return mapRef.current.leafletElement.options.crs;\r\n}\r\n","import React from \"react\";\r\nimport produce from \"immer\";\r\nimport { getBounds, getCrs } from \"./leaflet-helpers\";\r\nimport { GeoJSON, FeatureGroup, LayersControl } from \"react-leaflet\";\r\nimport { circleMarker } from \"leaflet\";\r\n\r\nexport function initialState(componentContext) {\r\n  return {\r\n    zoom: 10,\r\n    wfsServices: {},\r\n    selectedWfsService: \"\",\r\n    dragged: false\r\n  };\r\n}\r\n\r\nexport function createWfs(name, url, resource, typename, minZoom, maxZoom) {\r\n  return { name, url, resource, typename, minZoom, maxZoom, features: [] };\r\n}\r\n\r\nexport function registerWFS(componentContext, ...wfss) {\r\n  componentContext.setState(\r\n    produce(componentContext.state, draft => {\r\n      draft.selectedWfsService = wfss[0].typename;\r\n      wfss.forEach(wfs => (draft.wfsServices[wfs.typename] = wfs));\r\n    })\r\n  );\r\n  console.log(componentContext.state);\r\n}\r\n\r\nexport async function retrieveWFSFeatures(componentContext) {\r\n  return Object.entries(componentContext.state.wfsServices)\r\n    .filter(([key, value]) => key === componentContext.state.selectedWfsService)\r\n    .map(([key, value]) => {\r\n      return retrieveFeatures(\r\n        componentContext,\r\n        value.url,\r\n        value.resource,\r\n        value.typename\r\n      );\r\n    });\r\n}\r\n\r\nexport async function retrieveFeatures(\r\n  componentContext,\r\n  url,\r\n  resource,\r\n  typename\r\n) {\r\n  const bounds = getBounds(componentContext.mapRef);\r\n  const crs = getCrs(componentContext.mapRef);\r\n\r\n  componentContext.setState(\r\n    produce(componentContext.state, draft => {\r\n      draft.wfsServices[typename].features = [];\r\n    })\r\n  );\r\n  for await (const features of getPlotsGeoJSONData2(\r\n    componentContext,\r\n    bounds,\r\n    crs,\r\n    url,\r\n    resource,\r\n    typename\r\n  )) {\r\n    const stateFeatures = componentContext.state.wfsServices[typename].features;\r\n    const filteredFeatures = features.filter(\r\n      feature =>\r\n        !stateFeatures.find(stateFeature => feature.id === stateFeature.id)\r\n    );\r\n    componentContext.setState(\r\n      produce(componentContext.state, draft => {\r\n        draft.wfsServices[typename].features.push(...filteredFeatures);\r\n      })\r\n    );\r\n  }\r\n}\r\n\r\nasync function* getPlotsGeoJSONData2(\r\n  componentContext,\r\n  bounds,\r\n  crs,\r\n  url,\r\n  resource,\r\n  typename\r\n) {\r\n  const southWest = crs.project(bounds.getSouthWest());\r\n  const northEast = crs.project(bounds.getNorthEast());\r\n\r\n  const bbox = `${southWest.x},${southWest.y},${northEast.x},${northEast.y}`;\r\n\r\n  const wfsUrl = `${url}/${resource}/wfs`;\r\n  const getPlots = startIndex =>\r\n    fetch(\r\n      `${wfsUrl}?SERVICE=WFS&REQUEST=GetFeature&VERSION=2.0.0&TYPENAMES=${typename}&OUTPUTFORMAT=json&STARTINDEX=${startIndex}&COUNT=100&SRSNAME=urn:ogc:def:crs:EPSG::4326&BBOX=${bbox},urn:ogc:def:crs:EPSG::3857`\r\n    );\r\n  const response = await getPlots(0);\r\n  const json = await response.json();\r\n  yield json.features;\r\n  const totalFeatures = json.totalFeatures;\r\n  console.log(totalFeatures);\r\n  while (\r\n    componentContext.state.wfsServices[typename].features.length < totalFeatures\r\n  ) {\r\n    const nextResponse = await getPlots(\r\n      componentContext.state.wfsServices[typename].features.length\r\n    );\r\n    const nextJson = await nextResponse.json();\r\n    yield nextJson.features;\r\n  }\r\n}\r\n\r\nexport function handleZoomEnd(componentContext) {\r\n  return e => {\r\n    const prev = componentContext.state.zoom;\r\n    const curr = e.target.getZoom();\r\n    console.log(prev, curr);\r\n    const minZoom =\r\n      componentContext.state.wfsServices[\r\n        componentContext.state.selectedWfsService\r\n      ].minZoom;\r\n    const maxZoom =\r\n      componentContext.state.wfsServices[\r\n        componentContext.state.selectedWfsService\r\n      ].maxZoom;\r\n    componentContext.setState(\r\n      produce(componentContext.state, draft => {\r\n        draft.zoom = curr;\r\n      })\r\n    );\r\n    // TODO: Switch statement?\r\n    if (prev < minZoom && curr >= minZoom) {\r\n      retrieveWFSFeatures(componentContext);\r\n      componentContext.setState(\r\n        produce(componentContext.state, draft => {\r\n          draft.dragged = false;\r\n        })\r\n      );\r\n    } else if (prev >= minZoom && curr < minZoom) {\r\n      componentContext.setState(\r\n        produce(componentContext.state, draft => {\r\n          draft.wfsServices[\r\n            componentContext.state.selectedWfsService\r\n          ].features = [];\r\n        })\r\n      );\r\n    } else if (curr === minZoom + 1 && curr < prev) {\r\n      // If zoomed out to the max zoom level then put dragged to false as well\r\n      retrieveWFSFeatures(componentContext);\r\n      componentContext.setState(\r\n        produce(componentContext.state, draft => {\r\n          draft.dragged = false;\r\n        })\r\n      );\r\n    } else if (\r\n      curr >= minZoom &&\r\n      curr < prev &&\r\n      componentContext.state.dragged\r\n    ) {\r\n      // If dragged, then we need to get new BRP on zoom out\r\n      retrieveWFSFeatures(componentContext);\r\n    }\r\n  };\r\n}\r\n\r\nexport function handleDragEnd(componentContext) {\r\n  return () => {\r\n    const minZoom =\r\n      componentContext.state.wfsServices[\r\n        componentContext.state.selectedWfsService\r\n      ].minZoom;\r\n    const maxZoom =\r\n      componentContext.state.wfsServices[\r\n        componentContext.state.selectedWfsService\r\n      ].maxZoom;\r\n    if (componentContext.state.zoom >= minZoom) {\r\n      retrieveWFSFeatures(componentContext);\r\n      componentContext.setState(\r\n        produce(componentContext.state, draft => {\r\n          draft.dragged = true;\r\n        })\r\n      );\r\n    }\r\n  };\r\n}\r\n\r\nexport function onPointToLayer(feature, latlng) {\r\n  // console.log(feature.properties.value + 200);\r\n  return circleMarker(latlng, {\r\n    radius: 8,\r\n    fillColor: \"#ff7800\",\r\n    color: \"#000\",\r\n    weight: 1,\r\n    opacity: 1,\r\n    fillOpacity: 0.8\r\n  });\r\n}\r\n\r\nexport function createFeatureLayers(componentContext, onFeatureClick) {\r\n  return Object.entries(componentContext.state.wfsServices)\r\n    .filter(([key, value]) => key === componentContext.state.selectedWfsService)\r\n    .map(([key, value]) => (\r\n      <FeatureGroup key={key} onClick={onFeatureClick}>\r\n        {value.features.map(geoJSONData => (\r\n          <GeoJSON\r\n            data={geoJSONData}\r\n            key={geoJSONData.id}\r\n            style={{ color: \"blue\", fillOpacity: 0 }}\r\n            pointToLayer={onPointToLayer}\r\n          />\r\n        ))}\r\n      </FeatureGroup>\r\n    ));\r\n}\r\n\r\nexport function selectWfsService(componentContext) {\r\n  return e => {\r\n    const minZoom = componentContext.state.wfsServices[e.target.value].minZoom;\r\n    const maxZoom = componentContext.state.wfsServices[e.target.value].maxZoom;\r\n    componentContext.setState(\r\n      produce(componentContext.state, draft => {\r\n        draft.wfsServices[\r\n          componentContext.state.selectedWfsService\r\n        ].features = [];\r\n        draft.selectedWfsService = e.target.value;\r\n      })\r\n    );\r\n\r\n    if (componentContext.state.zoom >= minZoom) {\r\n      // Using this so we can use the call back that gets called once react rerendered the component\r\n      componentContext.forceUpdate(() => {\r\n        retrieveWFSFeatures(componentContext);\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\nconst shorten = (value, maxLength = 18, first = 8, last = 8) => {\r\n  if (value.toString().length <= maxLength) return value;\r\n\r\n  const pre = value.toString().substr(0, first);\r\n  const app = value.toString().substr(value.length - last, last);\r\n  return `${pre}...${app}`;\r\n};\r\n\r\nexport function wfsServiceDropdown(componentContext) {\r\n  return (\r\n    <select\r\n      className=\"like-leaflet\"\r\n      onChange={selectWfsService(componentContext)}\r\n      value={componentContext.state.selectedWfsService}\r\n    >\r\n      {Object.entries(componentContext.state.wfsServices).map(\r\n        ([key, value]) => (\r\n          <option key={key} value={key}>\r\n            {shorten(value.name)}\r\n          </option>\r\n        )\r\n      )}\r\n    </select>\r\n  );\r\n}\r\n","import React, { PureComponent, createRef } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport \"./viewer.css\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport {\r\n  Map,\r\n  TileLayer,\r\n  WMSTileLayer,\r\n  LayersControl,\r\n  LayerGroup,\r\n  ZoomControl,\r\n  AttributionControl\r\n} from \"react-leaflet\";\r\nimport produce from \"immer\";\r\nimport {\r\n  createFeatureLayers,\r\n  handleZoomEnd,\r\n  handleDragEnd,\r\n  initialState,\r\n  registerWFS,\r\n  createWfs,\r\n  wfsServiceDropdown\r\n} from \"../utils/wfs-helper\";\r\n\r\nimport logo from \"../images/logo-vaa.svg\";\r\nimport locate from \"../images/locate.svg\";\r\nimport camera from \"../images/camera.svg\";\r\nimport download from \"../images/download.svg\";\r\nimport { Graph } from \"../graph/graph\";\r\nimport L from \"leaflet\";\r\n\r\nconst { BaseLayer, Overlay } = LayersControl;\r\n\r\nclass Viewer extends PureComponent {\r\n  mapRef = createRef();\r\n\r\n  selectedLayer;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = produce(initialState(), draft => {\r\n      draft.lat = 51.84276079;\r\n      draft.lon = 5.18380148;\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    registerWFS(\r\n      this,\r\n      createWfs(\r\n        \"BRP Gewaspercelen\",\r\n        \"https://geodata.nationaalgeoregister.nl\",\r\n        \"brpgewaspercelen\",\r\n        \"brpgewaspercelen:brpgewaspercelen\",\r\n        14,\r\n        undefined\r\n      ),\r\n      createWfs(\r\n        \"Gemeenten\",\r\n        \"https://geodata.nationaalgeoregister.nl\",\r\n        \"bestuurlijkegrenzen\",\r\n        \"bestuurlijkegrenzen:gemeenten\",\r\n        11,\r\n        undefined\r\n      ),\r\n      createWfs(\r\n        \"Basis registratie Kadaster\",\r\n        \"https://geodata.nationaalgeoregister.nl\",\r\n        \"kadastralekaartv3\",\r\n        \"kadastralekaartv3:perceel\",\r\n        14,\r\n        undefined\r\n      ),\r\n      createWfs(\r\n        \"Agrarisch Areaal Nederland (AAN)\",\r\n        \"https://geodata.nationaalgeoregister.nl\",\r\n        \"aan\",\r\n        \"aan:aan\",\r\n        14,\r\n        undefined\r\n      ),\r\n      createWfs(\r\n        \"BAG\",\r\n        \"https://geodata.nationaalgeoregister.nl/\",\r\n        \"bag\",\r\n        \"bag:pand\",\r\n        14,\r\n        undefined\r\n      ),\r\n      createWfs(\r\n        \"Adressen\",\r\n        \"https://geodata.nationaalgeoregister.nl/\",\r\n        \"inspireadressen\",\r\n        \"inspireadressen:inspireadressen\",\r\n        14,\r\n        undefined\r\n      ),\r\n      // Kan alleen xml\r\n      // createWfs(\r\n      //   \"Fysisch Geografische Regio’s\",\r\n      //   \"https://geodata.nationaalgeoregister.nl/\",\r\n      //   \"fysischgeografischeregios\",\r\n      //   \"fysischgeografischeregios:fysischgeografischeregios\"\r\n      // ),\r\n      createWfs(\r\n        \"Bodemkaart 1:50.000\",\r\n        \"https://geodata.nationaalgeoregister.nl/\",\r\n        \"bodemkaart50000\",\r\n        \"bodemkaart50000:bodemkaart50000\",\r\n        14,\r\n        undefined\r\n      ),\r\n      // createWfs(\r\n      //   \"Bestand bodemgebruik (CBS)\",\r\n      //   \"https://geodata.nationaalgeoregister.nl/\",\r\n      //   \"bestandbodemgebruik2015\",\r\n      //   \"bestandbodemgebruik2015:bbg2015_hoofdgroep\"\r\n      // ),\r\n      createWfs(\r\n        \"Landsgrens\",\r\n        \"https://geodata.nationaalgeoregister.nl\",\r\n        \"bestuurlijkegrenzen\",\r\n        \"bestuurlijkegrenzen:landsgrens\",\r\n        2,\r\n        undefined\r\n      ),\r\n      createWfs(\r\n        \"Provincies\",\r\n        \"https://geodata.nationaalgeoregister.nl\",\r\n        \"bestuurlijkegrenzen\",\r\n        \"bestuurlijkegrenzen:provincies\",\r\n        2,\r\n        undefined\r\n      )\r\n    );\r\n  }\r\n\r\n  handleFeatureClick = e => {\r\n    if (this.selectedLayer) {\r\n      this.selectedLayer.setStyle({\r\n        color: \"blue\",\r\n        fillOpacity: 0\r\n      });\r\n    }\r\n    this.selectedLayer = e.layer;\r\n    this.selectedLayer.setStyle({\r\n      color: \"red\",\r\n      fillOpacity: 0.2\r\n    });\r\n\r\n    this.selectedLayer.bringToFront();\r\n    console.log(e.layer.feature);\r\n  };\r\n\r\n  locateUser = () => {\r\n    this.mapRef.current.leafletElement.locate({\r\n      setView: true,\r\n      watch: true,\r\n      maxZoom: 20\r\n    });\r\n  };\r\n\r\n  handleLocationFound = e => {\r\n    const map = this.mapRef.current.leafletElement;\r\n    var radius = e.accuracy / 2;\r\n    L.marker(e.latlng)\r\n      .addTo(map)\r\n      .bindPopup(\"You are within \" + radius + \" meters from this point\")\r\n      .openPopup();\r\n    L.circle(e.latlng, 1).addTo(map);\r\n  };\r\n\r\n  async takePicture() {}\r\n\r\n  render() {\r\n    const position = [this.state.lat, this.state.lon];\r\n    return (\r\n      <>\r\n        <div className=\"map\">\r\n          <div className=\"like-leaflet logo\">\r\n            <img src={logo} alt=\"logo\" />\r\n            {/* <header>BEESPOT</header> */}\r\n          </div>\r\n          <div className=\"wfs-dropdown\">{wfsServiceDropdown(this)}</div>\r\n          <div className=\"like-leaflet locate\" onClick={this.locateUser}>\r\n            <img src={locate} alt=\"locate\" />\r\n          </div>\r\n          {this.props.promptInstall && (\r\n            <div\r\n              className=\"like-leaflet install\"\r\n              onClick={this.props.promptInstall}\r\n            >\r\n              <img src={download} alt=\"install\" />\r\n            </div>\r\n          )}\r\n          <Link to=\"/pic\">\r\n            <div className=\"like-leaflet camera-button\">\r\n              <img src={camera} alt=\"camera\" />\r\n            </div>\r\n          </Link>\r\n\r\n          {/* <div className=\"buttons\">\r\n            <div className=\"\">\r\n              <a>chart</a>\r\n              <a>detail</a>\r\n            </div>\r\n          </div> */}\r\n          <Map\r\n            center={position}\r\n            zoom={this.state.zoom}\r\n            onZoomEnd={handleZoomEnd(this)}\r\n            onDragEnd={handleDragEnd(this)}\r\n            onClick={this.handleClick}\r\n            onLocationfound={this.handleLocationFound}\r\n            ref={this.mapRef}\r\n            className=\"leaflet-map\"\r\n            zoomControl={false}\r\n            attributionControl={false}\r\n          >\r\n            <AttributionControl position=\"topright\" />\r\n            <ZoomControl position=\"bottomright\" />\r\n            <LayersControl position=\"topright\">\r\n              <BaseLayer checked name=\"OpenStreetMap\">\r\n                <TileLayer\r\n                  attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n                  url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                />\r\n              </BaseLayer>\r\n              {/* <BaseLayer name=\"Test\">\r\n                  <TileLayer\r\n                    attribution=\"&amp;copy PDOK\"\r\n                    url=\"https://geodata.nationaalgeoregister.nl/luchtfoto/infrarood/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=Actueel_ortho25IR&STYLE=default&TILEMATRIXSET=EPSG:3857&TILEMATRIX={z}&TILEROW={x}&TILECOL={y}&FORMAT=image%2Fpng\"\r\n                  />\r\n                </BaseLayer> */}\r\n              <BaseLayer name=\"Luchtfoto\">\r\n                <LayerGroup>\r\n                  <WMSTileLayer\r\n                    url=\"https://geodata.nationaalgeoregister.nl/luchtfoto/rgb/wms?\"\r\n                    layers=\"Actueel_ortho25\"\r\n                  />\r\n                  {/* <TileLayer\r\n                      url=\"https://geodata.nationaalgeoregister.nl/tiles/service/tms/1.0.0/lufolabels/EPSG:28992/{z}/{x}/{y}.png\"\r\n                      tms={true}\r\n                    /> */}\r\n                </LayerGroup>\r\n              </BaseLayer>\r\n              <BaseLayer name=\"Luchtfoto Infrarood\">\r\n                <WMSTileLayer\r\n                  url=\"https://geodata.nationaalgeoregister.nl/luchtfoto/infrarood/wms?\"\r\n                  layers=\"Actueel_ortho25IR\"\r\n                />\r\n              </BaseLayer>\r\n              <Overlay name=\"BRP Gewaspercelen (WMS)\">\r\n                <WMSTileLayer\r\n                  url=\"https://geodata.nationaalgeoregister.nl/brpgewaspercelen/wms?\"\r\n                  layers=\"brpgewaspercelen:brpgewaspercelen\"\r\n                  transparent={true}\r\n                  format=\"image/png\"\r\n                  opacity={0.8}\r\n                />\r\n              </Overlay>\r\n              <Overlay name=\"gemiddelde toegevoegde waarde per hectare weer van voedselteelten in de akkerbouw (2011-2014)\">\r\n                <WMSTileLayer\r\n                  url=\"http://geodata.rivm.nl/geoserver/wms?\"\r\n                  layers=\"dank:lei_l1a_gc_akkerbvoed\"\r\n                  transparent={true}\r\n                  format=\"image/png\"\r\n                  opacity={0.8}\r\n                />\r\n              </Overlay>\r\n              <Overlay name=\"Agrarisch Areaal Nederland (AAN)\">\r\n                <WMSTileLayer\r\n                  url=\"https://geodata.nationaalgeoregister.nl/aan/wms?\"\r\n                  layers=\"aan\"\r\n                  transparent={true}\r\n                  format=\"image/png\"\r\n                  opacity={0.8}\r\n                />\r\n              </Overlay>\r\n              <Overlay name=\"Actueel Hoogtebestand Nederland 3\">\r\n                <WMSTileLayer\r\n                  url=\"https://geodata.nationaalgeoregister.nl/ahn3/wms\"\r\n                  layers=\"ahn3_05m_dsm\"\r\n                  transparent={true}\r\n                  format=\"image/png\"\r\n                  opacity={0.8}\r\n                />\r\n              </Overlay>\r\n              <Overlay name=\"Bestand bodemgebruik\">\r\n                <WMSTileLayer\r\n                  url=\"https://geodata.nationaalgeoregister.nl/bestandbodemgebruik2015/wms\"\r\n                  layers=\"bbg2015\"\r\n                  transparent={true}\r\n                  format=\"image/png\"\r\n                  opacity={0.8}\r\n                />\r\n              </Overlay>\r\n              {/* <Overlay checked name=\"geoJson\">\r\n                <GeoJSON data={this.geoJson} />\r\n              </Overlay> */}\r\n            </LayersControl>\r\n            {createFeatureLayers(this, this.handleFeatureClick)}\r\n          </Map>\r\n        </div>\r\n        {/* <div className=\"charts\">\r\n          <Graph />\r\n        </div> */}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Viewer;\r\n","import React from \"react\";\r\nimport Plot from \"react-plotly.js\";\r\n\r\nexport class Graph extends React.Component {\r\n  render() {\r\n    return (\r\n      <Plot\r\n        config={{\r\n          responsive: true,\r\n          modeBarButtons: [\r\n            []\r\n            // [\"zoom2d\", \"pan2d\"],\r\n            // [\"zoomIn2d\", \"zoomOut2d\", \"autoScale2d\"]\r\n          ],\r\n          displaylogo: false\r\n        }}\r\n        data={[\r\n          {\r\n            x: [\r\n              \"Januari\",\r\n              \"Februari\",\r\n              \"Maart\",\r\n              \"April\",\r\n              \"Mei\",\r\n              \"Juni\",\r\n              \"Juli\",\r\n              \"Augustus\",\r\n              \"September\",\r\n              \"Oktober\",\r\n              \"November\",\r\n              \"December\"\r\n            ],\r\n            y: [\r\n              \"0.005\",\r\n              \"0.03\",\r\n              \"0.09\",\r\n              \"0.426\",\r\n              \"0.82\",\r\n              \"1.69\",\r\n              \"1.67\",\r\n              \"1.462\",\r\n              \"0.90\",\r\n              \"0.24\",\r\n              \"0.043\",\r\n              \"0.008\"\r\n            ],\r\n            name: \"Pollen\",\r\n            type: \"bar\"\r\n          },\r\n          {\r\n            x: [\r\n              \"Januari\",\r\n              \"Februari\",\r\n              \"Maart\",\r\n              \"April\",\r\n              \"Mei\",\r\n              \"Juni\",\r\n              \"Juli\",\r\n              \"Augustus\",\r\n              \"September\",\r\n              \"Oktober\",\r\n              \"November\",\r\n              \"December\"\r\n            ],\r\n            y: [\r\n              \"0.005\",\r\n              \"0.015\",\r\n              \"0.07\",\r\n              \"0.423\",\r\n              \"0.81\",\r\n              \"1.18\",\r\n              \"1.19\",\r\n              \"1.057\",\r\n              \"0.894\",\r\n              \"0.23\",\r\n              \"0.042\",\r\n              \"0.008\"\r\n            ],\r\n            name: \"Nectar\",\r\n            type: \"bar\"\r\n          }\r\n        ]}\r\n        layout={{\r\n          margin: { l: 50, t: 5, r: 40, b: 75 },\r\n          legend: {\r\n            x: 0,\r\n            y: 1\r\n          },\r\n          autosize: true\r\n        }}\r\n      />\r\n    );\r\n  }\r\n}\r\n","import React, { PureComponent, createRef } from \"react\";\r\nimport \"ol/ol.css\";\r\nimport \"./open-layers.css\";\r\nimport { Map, View } from \"ol\";\r\nimport TileLayer from \"ol/layer/Tile\";\r\nimport VectorLayer from \"ol/layer/Vector\";\r\nimport OSM from \"ol/source/OSM\";\r\nimport GeoJSON from \"ol/format/GeoJSON.js\";\r\nimport VectorSource from \"ol/source/Vector.js\";\r\nimport { bbox as bboxStrategy } from \"ol/loadingstrategy.js\";\r\nimport { Fill, Stroke, Style } from \"ol/style.js\";\r\n\r\nimport Natuur from \"../Natuur\";\r\nimport Bestemmingsplan from \"../Bestemmingsplan\";\r\nimport produce from \"immer\";\r\n\r\nimport bij from \"../images/bij.png\";\r\nimport tent from \"../images/tent.png\";\r\nimport tree from \"../images/tree.png\";\r\nimport windmill from \"../images/windmill.png\";\r\n\r\nexport class OpenLayers extends PureComponent {\r\n  map;\r\n  currentLayer;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = produce({}, draft => {\r\n      draft.radio = \"\";\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.map = new Map({\r\n      target: \"map\",\r\n      layers: [\r\n        new TileLayer({\r\n          source: new OSM()\r\n        })\r\n      ],\r\n      view: new View({\r\n        center: [638956.992885993327945, 6826972.975618642754853], // Ongeveer midden Nederland\r\n        zoom: 12\r\n      })\r\n    });\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (prevState.radio !== this.state.radio) {\r\n      if (this.currentLayer) {\r\n        this.map.removeLayer(this.currentLayer);\r\n        this.currentLayer = undefined;\r\n      }\r\n\r\n      if (this.state.radio === \"windmolen\") {\r\n        const vectorSource = new VectorSource({\r\n          features: new GeoJSON().readFeatures(Bestemmingsplan)\r\n        });\r\n        this.currentLayer = new VectorLayer({\r\n          source: vectorSource,\r\n          style: new Style({\r\n            fill: new Fill({\r\n              color: \"rgba(0, 0, 255, 0.4)\"\r\n            }),\r\n            stroke: new Stroke({\r\n              color: \"rgba(0, 0, 255, 1.0)\",\r\n              width: 2\r\n            })\r\n          })\r\n        });\r\n\r\n        this.map.addLayer(this.currentLayer);\r\n      }\r\n\r\n      if (this.state.radio === \"voedselbos\") {\r\n        const vectorSource2 = new VectorSource({\r\n          features: new GeoJSON().readFeatures(Natuur)\r\n        });\r\n        this.currentLayer = new VectorLayer({\r\n          source: vectorSource2,\r\n          style: new Style({\r\n            fill: new Fill({\r\n              color: \"rgba(0, 255, 0, 0.4)\"\r\n            }),\r\n            stroke: new Stroke({\r\n              color: \"rgba(0, 255, 0, 1.0)\",\r\n              width: 2\r\n            })\r\n          })\r\n        });\r\n\r\n        this.map.addLayer(this.currentLayer);\r\n      }\r\n\r\n      if (this.state.radio === \"bijenkast\") {\r\n      }\r\n\r\n      if (this.state.radio === \"camping\") {\r\n      }\r\n    }\r\n  }\r\n\r\n  onRadioChange = e => {\r\n    this.setState(\r\n      produce(this.state, draft => {\r\n        draft.radio = e.currentTarget.value;\r\n      })\r\n    );\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container\">\r\n        <div className=\"side\">\r\n          <div className=\"radios\">\r\n            <p>Kansen:</p>\r\n            <div className=\"radio-button\">\r\n              <input\r\n                type=\"radio\"\r\n                id=\"windmolen\"\r\n                name=\"kansen\"\r\n                value=\"windmolen\"\r\n                checked={this.state.radio === \"windmolen\"}\r\n                onChange={this.onRadioChange}\r\n              />\r\n              <label htmlFor=\"windmolen\">\r\n                Windmolen{\" \"}\r\n                <img src={windmill} alt=\"Windmolen\" className=\"icon\" />\r\n              </label>\r\n            </div>\r\n            <div className=\"radio-button\">\r\n              <input\r\n                type=\"radio\"\r\n                id=\"voedselbos\"\r\n                name=\"kansen\"\r\n                value=\"voedselbos\"\r\n                checked={this.state.radio === \"voedselbos\"}\r\n                onChange={this.onRadioChange}\r\n              />\r\n              <label htmlFor=\"voedselbos\">\r\n                Voedselbos <img src={tree} alt=\"Natuur\" className=\"icon\" />\r\n              </label>\r\n            </div>\r\n            <div className=\"radio-button\">\r\n              <input\r\n                type=\"radio\"\r\n                id=\"bijenkast\"\r\n                name=\"kansen\"\r\n                value=\"bijenkast\"\r\n                checked={this.state.radio === \"bijenkast\"}\r\n                onChange={this.onRadioChange}\r\n              />\r\n              <label htmlFor=\"bijenkast\">\r\n                Bijenkast <img src={bij} alt=\"Bijenkast\" className=\"icon\" />\r\n              </label>\r\n            </div>\r\n            <div className=\"radio-button\">\r\n              <input\r\n                type=\"radio\"\r\n                id=\"camping\"\r\n                name=\"kansen\"\r\n                value=\"camping\"\r\n                checked={this.state.radio === \"camping\"}\r\n                onChange={this.onRadioChange}\r\n              />\r\n              <label htmlFor=\"camping\">\r\n                Camping <img src={tent} alt=\"Camping\" className=\"icon\" />\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div id=\"map\" />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { PureComponent } from \"react\";\r\nimport adapter from \"webrtc-adapter\";\r\nimport \"./styles.css\";\r\n\r\nexport class Pic extends PureComponent {\r\n  width = 640; // We will scale the photo width to this\r\n  height = 0; // This will be computed based on the input stream\r\n\r\n  streaming = false;\r\n\r\n  video = null;\r\n  canvas = null;\r\n  photo = null;\r\n  startbutton = null;\r\n  startrecording = null;\r\n\r\n  constructor() {\r\n    super();\r\n    // this.video = React.createRef();\r\n    this.canvas = React.createRef();\r\n    this.photo = React.createRef();\r\n    this.startbutton = React.createRef();\r\n    this.startrecording = React.createRef();\r\n\r\n    // Older browsers might not implement mediaDevices at all, so we set an empty object first\r\n    if (navigator.mediaDevices === undefined) {\r\n      navigator.mediaDevices = {};\r\n    }\r\n\r\n    // Some browsers partially implement mediaDevices. We can't just assign an object\r\n    // with getUserMedia as it would overwrite existing properties.\r\n    // Here, we will just add the getUserMedia property if it's missing.\r\n    if (navigator.mediaDevices.getUserMedia === undefined) {\r\n      navigator.mediaDevices.getUserMedia = function(constraints) {\r\n        // First get ahold of the legacy getUserMedia, if present\r\n        var getUserMedia =\r\n          navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\r\n\r\n        // Some browsers just don't implement it - return a rejected promise with an error\r\n        // to keep a consistent interface\r\n        if (!getUserMedia) {\r\n          return Promise.reject(\r\n            new Error(\"getUserMedia is not implemented in this browser\")\r\n          );\r\n        }\r\n\r\n        // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\r\n        return new Promise(function(resolve, reject) {\r\n          getUserMedia.call(navigator, constraints, resolve, reject);\r\n        });\r\n      };\r\n    }\r\n  }\r\n\r\n  paintVideo = () => {\r\n    if (this.canvas.current) {\r\n      this.canvas.current\r\n        .getContext(\"2d\")\r\n        .drawImage(\r\n          this.video.current,\r\n          0,\r\n          0,\r\n          this.canvas.current.width,\r\n          this.canvas.current.height\r\n        );\r\n      if (!this.video.current.paused) requestAnimationFrame(this.paintVideo);\r\n    }\r\n  };\r\n\r\n  useCamera = () => {\r\n    const video = this.video.current;\r\n    video.muted = true;\r\n    video.setAttribute(\"playsinline\", true); // required to tell iOS safari we don't want fullscreen\r\n    video.play();\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.video = { current: document.createElement(\"video\") };\r\n    const video = this.video.current;\r\n    video.muted = true;\r\n    video.playsinline = true;\r\n    video[\"webkit-playsinline\"] = true;\r\n    video.addEventListener(\"playing\", this.paintVideo);\r\n\r\n    navigator.mediaDevices\r\n      .getUserMedia({ video: { facingMode: \"environment\" } })\r\n      .then(stream => {\r\n        // Older browsers may not have srcObject\r\n        if (\"srcObject\" in video) {\r\n          video.srcObject = stream;\r\n        } else {\r\n          // Avoid using this in new browsers, as it is going away.\r\n          video.src = window.URL.createObjectURL(stream);\r\n        }\r\n        video.setAttribute(\"playsinline\", true); // required to tell iOS safari we don't want fullscreen\r\n        video.play();\r\n      })\r\n      .catch(err => {\r\n        console.log(\"An error occurred: \" + err);\r\n      });\r\n\r\n    // video.onloadedmetadata = e => {\r\n    //   video.play();\r\n    // };\r\n\r\n    // this.video.current.addEventListener(\r\n    //   \"canplay\",\r\n    //   ev => {\r\n    //     if (!this.streaming) {\r\n    //       this.height =\r\n    //         this.video.current.videoHeight /\r\n    //         (this.video.current.videoWidth / this.width);\r\n\r\n    //       this.video.current.setAttribute(\"width\", this.width);\r\n    //       this.video.current.setAttribute(\"height\", this.height);\r\n    //       this.canvas.current.setAttribute(\"width\", this.width);\r\n    //       this.canvas.current.setAttribute(\"height\", this.height);\r\n    //       this.streaming = true;\r\n    //     }\r\n    //   },\r\n    //   false\r\n    // );\r\n\r\n    this.startbutton.current.addEventListener(\r\n      \"click\",\r\n      ev => {\r\n        this.takepicture();\r\n        ev.preventDefault();\r\n      },\r\n      false\r\n    );\r\n\r\n    // this.startrecording.current.addEventListener(\r\n    //   \"click\",\r\n    //   this.useCamera,\r\n    //   false\r\n    // );\r\n  }\r\n\r\n  takepicture() {\r\n    var data = this.canvas.current.toDataURL(\"image/png\");\r\n    this.photo.current.setAttribute(\"src\", data);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <input type=\"file\" accept=\"image/*\" capture=\"camera\"></input>\r\n        <div className=\"camera\">\r\n          <button onclick=\"this.useCamera()\">Start recording</button>\r\n          {/* <video\r\n            className=\"video either-gif-or-video\"\r\n            ref={this.video}\r\n            muted\r\n            autoplay\r\n            playsinline\r\n            webkit-playsinline\r\n          >\r\n            Video stream not available.\r\n          </video> */}\r\n          <button className=\"startbutton\" ref={this.startbutton}>\r\n            Take photo\r\n          </button>\r\n        </div>\r\n        <canvas className=\"canvas\" ref={this.canvas}></canvas>\r\n        <div className=\"output\">\r\n          <img\r\n            className=\"photo\"\r\n            ref={this.photo}\r\n            alt=\"The screen capture will appear in this box.\"\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport Viewer from \"./viewer/viewer\";\r\nimport { OpenLayers } from \"./open-layers/open-layers\";\r\nimport { Route, Switch } from \"react-router-dom\";\r\nimport { Pic } from \"./pic\";\r\n\r\nclass App extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <Switch>\r\n          <Route\r\n            exact\r\n            path=\"/\"\r\n            component={Viewer}\r\n            render={() => {\r\n              return <Viewer promptInstall={this.props.promptInstall}></Viewer>;\r\n            }}\r\n          />\r\n          <Route exact path=\"/pic\" component={Pic} />\r\n          <Route path=\"/v2\" component={OpenLayers} />\r\n        </Switch>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n\n              // Execute callback\n              if (config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\nimport { BrowserRouter } from \"react-router-dom\";\r\n\r\nlet deferredPrompt;\r\n\r\nwindow.addEventListener(\"beforeinstallprompt\", e => {\r\n  // Stash the event so it can be triggered later.\r\n  deferredPrompt = e;\r\n});\r\n\r\nconst promptInstall = () => {\r\n  if (deferredPrompt) {\r\n    deferredPrompt.prompt();\r\n    deferredPrompt = undefined;\r\n  }\r\n};\r\n\r\nReactDOM.render(\r\n  <BrowserRouter basename={process.env.PUBLIC_URL}>\r\n    <App promptInstall={promptInstall} />\r\n  </BrowserRouter>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.register({\r\n  onUpdate: () => {},\r\n  onSuccess: () => {}\r\n});\r\n"],"sourceRoot":""}